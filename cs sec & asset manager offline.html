<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SecurityDB Dashboard (Offline)</title>
    
    <style>
        /* --- 1. RESET & VARIABLES --- */
        :root {
            --primary: #0d6efd;
            --secondary: #6c757d;
            --success: #198754;
            --danger: #dc3545;
            --warning: #ffc107;
            --dark: #212529;
            --light: #f8f9fa;
            --white: #fff;
            --border-color: #dee2e6;
        }
        
        * { box-sizing: border-box; }
        body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, sans-serif; background-color: #f8f9fa; margin: 0; padding: 20px; color: #212529; }
        
        /* --- 2. GRID SYSTEM (Mini-Bootstrap) --- */
        .container { max-width: 960px; margin: 0 auto; }
        .row { display: flex; flex-wrap: wrap; margin-left: -10px; margin-right: -10px; }
        .col-md-4 { width: 33.33%; padding: 10px; }
        .col-md-6 { width: 50%; padding: 10px; }
        .col-6 { width: 50%; padding: 0 5px; }
        /* Mobile Responsive */
        @media (max-width: 768px) {
            .col-md-4, .col-md-6 { width: 100%; }
        }

        /* --- 3. UTILITIES --- */
        .d-flex { display: flex; }
        .justify-content-between { justify-content: space-between; }
        .align-items-center { align-items: center; }
        .text-center { text-align: center; }
        .mt-5 { margin-top: 3rem; }
        .mb-3 { margin-bottom: 1rem; }
        .mb-4 { margin-bottom: 1.5rem; }
        .p-4 { padding: 1.5rem; }
        .p-2 { padding: 0.5rem; }
        .me-1 { margin-right: 0.25rem; }
        .me-2 { margin-right: 0.5rem; }
        .w-100 { width: 100%; }
        .rounded-top { border-top-left-radius: 5px; border-top-right-radius: 5px; }
        .text-muted { color: #6c757d; }
        .small { font-size: 0.875em; }
        
        /* --- 4. COMPONENTS --- */
        /* Header */
        header { background-color: var(--dark); color: var(--white); }
        
        /* Navigation Tabs */
        .nav-tabs { display: flex; list-style: none; padding: 0; margin: 0; border-bottom: 1px solid var(--border-color); background: var(--white); }
        .nav-link { display: block; padding: 10px 15px; text-decoration: none; color: var(--primary); border: 1px solid transparent; border-bottom: none; cursor: pointer; }
        .nav-link:hover { background-color: #e9ecef; border-radius: 5px 5px 0 0; }
        .nav-link.active { color: #495057; background-color: #fff; border-color: var(--border-color) var(--border-color) #fff; border-radius: 5px 5px 0 0; font-weight: bold; }
        
        .tab-content { background: var(--white); padding: 20px; border: 1px solid var(--border-color); border-top: none; box-shadow: 0 .125rem .25rem rgba(0,0,0,.075); }
        .tab-pane { display: none; }
        .tab-pane.active { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* Cards */
        .card { border: 1px solid var(--border-color); border-radius: 0.25rem; background-color: #fff; display: flex; flex-direction: column; min-width: 0; word-wrap: break-word; height: 100%; }
        .card-header { padding: 0.75rem 1.25rem; background-color: rgba(0,0,0,.03); border-bottom: 1px solid rgba(0,0,0,.125); font-weight: bold; }
        .card-body { flex: 1 1 auto; padding: 1.25rem; }
        .card-footer { padding: 0.75rem 1.25rem; background-color: rgba(0,0,0,.03); border-top: 1px solid rgba(0,0,0,.125); }
        
        /* Custom Card Styles */
        .card-header-custom { background-color: #343a40; color: white; border-bottom: 3px solid #28a745; }
        .border-primary { border-color: #0d6efd; }
        .border-danger { border-color: #dc3545; }
        .border-success { border-color: #198754; }
        .bg-light { background-color: #f8f9fa; }
        .h2 { font-size: 2rem; margin: 0; }
        
        /* Forms */
        .form-label { display: block; margin-bottom: 0.5rem; }
        .form-control, .form-select { display: block; width: 100%; padding: 0.375rem 0.75rem; font-size: 1rem; line-height: 1.5; color: #212529; background-color: #fff; border: 1px solid #ced4da; border-radius: 0.25rem; box-sizing: border-box; }
        .btn { display: inline-block; font-weight: 400; line-height: 1.5; text-align: center; text-decoration: none; vertical-align: middle; cursor: pointer; user-select: none; border: 1px solid transparent; padding: 0.375rem 0.75rem; font-size: 1rem; border-radius: 0.25rem; transition: color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out; }
        .btn-dark { color: #fff; background-color: #212529; border-color: #212529; }
        .btn-warning { color: #000; background-color: #ffc107; border-color: #ffc107; }
        
        /* Tables */
        .table { width: 100%; margin-bottom: 1rem; color: #212529; vertical-align: top; border-collapse: collapse; }
        .table th, .table td { padding: 0.75rem; border-bottom: 1px solid #dee2e6; text-align: left; }
        .table-striped tbody tr:nth-of-type(odd) { background-color: rgba(0,0,0,.05); }

        /* Badges */
        .badge { display: inline-block; padding: .35em .65em; font-size: .75em; font-weight: 700; line-height: 1; color: #fff; text-align: center; white-space: nowrap; vertical-align: baseline; border-radius: .25rem; }
        .severity-low { background-color: #007bff; }
        .severity-medium { background-color: #ffc107; color: #000; }
        .severity-high { background-color: #fd7e14; }
        .severity-critical { background-color: #dc3545; }

        /* Toast Notification */
        .toast-container { position: fixed; bottom: 20px; right: 20px; z-index: 1055; }
        .toast { width: 350px; max-width: 100%; pointer-events: auto; background-clip: padding-box; border: 1px solid rgba(0,0,0,.1); box-shadow: 0 0.5rem 1rem rgba(0,0,0,.15); border-radius: .25rem; color: white; display: none; align-items: center; padding: 10px;}
        .toast.show { display: flex; }
        .bg-success { background-color: #198754; }
        .bg-danger { background-color: #dc3545; }
        .btn-close { box-sizing: content-box; width: 1em; height: 1em; padding: .25em .25em; color: #fff; background: transparent url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23fff'%3e%3cpath d='M.293.293a1 1 0 0 1 1.414 0L8 6.586 14.293.293a1 1 0 1 1 1.414 1.414L9.414 8l6.293 6.293a1 1 0 0 1-1.414 1.414L8 9.414l-6.293 6.293a1 1 0 0 1-1.414-1.414L6.586 8 .293 1.707a1 1 0 0 1 0-1.414z'/%3e%3c/svg%3e") center/1em auto no-repeat; border: 0; border-radius: .25rem; opacity: .5; cursor: pointer; margin-left: auto;}
        
        /* Icons (Emoji fallback to avoid external fonts) */
        .icon-lg { font-size: 2rem; display: block; margin-bottom: 10px;}
        .text-primary { color: #0d6efd; }
        .text-danger { color: #dc3545; }
        .text-success { color: #198754; }
        
        .text-monospace { font-family: 'Courier New', Courier, monospace; }
    </style>
</head>
<body>

    <div class="container mt-5">
        <header class="rounded-top p-4 d-flex justify-content-between align-items-center">
            <div style="display: flex; align-items: center;">
                <div>
                    <h1 style="margin: 0; font-size: 1.5rem;">SecurityDB Dashboard</h1>
                </div>
            </div>
        </header>

        <ul class="nav-tabs">
            <li><a class="nav-link active" onclick="switchTab('dashboard')">Dashboard</a></li>
            <li><a class="nav-link" onclick="switchTab('operations')">Operations</a></li>
        </ul>

        <div class="tab-content rounded-bottom">
            
            <div class="tab-pane active" id="dashboard-pane">
                <h2 class="mb-4" style="font-size: 1.5rem;">Current Risk Overview</h2>

                <div class="row mb-4">
                    <div class="col-md-4">
                        <div class="card text-center border-primary bg-light">
                            <div class="card-body">
                                <span class="icon-lg">üñ•Ô∏è</span>
                                <h4 class="h2" id="totalAssets">1</h4>
                                <p class="text-primary">Total Assets</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card text-center border-danger bg-light">
                            <div class="card-body">
                                <span class="icon-lg">‚ö†Ô∏è</span>
                                <h4 class="h2" id="totalVulns">0</h4>
                                <p class="text-danger">Total Vulnerabilities</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card text-center border-success bg-light">
                            <div class="card-body">
                                <span class="icon-lg">‚úÖ</span>
                                <h4 class="h2">Active</h4>
                                <p class="text-success">DB Connection</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header card-header-custom">
                        üìã Risk Report (Joined Data)
                    </div>
                    <div class="card-body" style="padding: 0;">
                        <div style="overflow-x: auto;">
                            <table class="table table-striped mb-0">
                                <thead>
                                    <tr>
                                        <th>Asset Name</th>
                                        <th>CVE Code</th>
                                        <th>Severity</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody id="riskReportTableBody">
                                    <tr><td colspan="4" class="text-center text-muted p-4">No vulnerabilities recorded yet.</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div class="tab-pane" id="operations-pane">
                <div class="row">
                    
                    <div class="col-md-6">
                        <div class="card" style="border-color: #6c757d;">
                            <div class="card-header" style="background-color: #6c757d; color: white;">
                                ‚ûï Add Asset
                            </div>
                            <div class="card-body">
                                <form id="addAssetForm">
                                    <div class="mb-3">
                                        <label class="form-label small text-muted">Asset Name *</label>
                                        <input type="text" class="form-control" id="assetName" required placeholder="e.g. Web-Server-01">
                                    </div>
                                    <div class="d-flex mb-3" style="gap: 10px;">
                                        <div class="w-100">
                                            <label class="form-label small text-muted">Type</label>
                                            <input type="text" class="form-control" id="assetType" placeholder="e.g. Server">
                                        </div>
                                        <div class="w-100">
                                            <label class="form-label small text-muted">IP Address *</label>
                                            <input type="text" class="form-control" id="assetIP" required placeholder="e.g. 10.0.0.5">
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label small text-muted">Owner</label>
                                        <input type="text" class="form-control" id="assetOwner" placeholder="e.g. IT Dept">
                                    </div>
                                    <button type="submit" class="btn btn-dark w-100">Run INSERT Asset</button>
                                </form>
                            </div>
                            <div class="card-footer small" style="background-color: #212529; color: #198754;">
                                <p class="mb-1 text-uppercase text-muted">Current Assets (SELECT *)</p>
                                <div id="currentAssetsList" style="max-height: 150px; overflow-y: auto; font-family: monospace;">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="card border-warning">
                            <div class="card-header bg-warning" style="color: #000;">
                                ‚ò¢Ô∏è Report Vulnerability
                            </div>
                            <div class="card-body">
                                <form id="reportVulnForm">
                                    <div class="mb-3">
                                        <label class="form-label small text-muted">Target Asset *</label>
                                        <select class="form-select" id="vulnAssetId" required>
                                            <option value="">Select an Asset...</option>
                                        </select>
                                    </div>
                                    <div class="d-flex mb-3" style="gap: 10px;">
                                        <div class="w-100">
                                            <label class="form-label small text-muted">CVE Code *</label>
                                            <input type="text" class="form-control" id="vulnCve" required placeholder="e.g. CVE-2023-1234">
                                        </div>
                                        <div class="w-100">
                                            <label class="form-label small text-muted">Severity</label>
                                            <select class="form-select" id="vulnSeverity">
                                                <option value="Low">Low</option>
                                                <option value="Medium">Medium</option>
                                                <option value="High">High</option>
                                                <option value="Critical">Critical</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label small text-muted">Description</label>
                                        <input type="text" class="form-control" id="vulnDesc" placeholder="Brief description...">
                                    </div>
                                    <button type="submit" class="btn btn-warning w-100">Run INSERT Vulnerability</button>
                                </form>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            
        </div>
    </div>
    
    <div class="toast-container">
      <div id="liveToast" class="toast">
        <div class="d-flex w-100 align-items-center">
          <div class="toast-body" id="toastBody" style="flex-grow: 1;">
            Notification text
          </div>
          <button type="button" class="btn-close" onclick="hideToast()"></button>
        </div>
      </div>
    </div>

    <script>
        // --- DATA SIMULATION (State) ---
        let assets = [
            { id: 1, name: 'Main-Server-01', type: 'Linux Server', ip: '192.168.1.10', owner: 'Admin' }
        ];
        let vulnerabilities = [];

        // --- DOM ELEMENTS ---
        const totalAssetsEl = document.getElementById('totalAssets');
        const totalVulnsEl = document.getElementById('totalVulns');
        const riskReportTableBody = document.getElementById('riskReportTableBody');
        const currentAssetsList = document.getElementById('currentAssetsList');
        const vulnAssetSelect = document.getElementById('vulnAssetId');
        const toastEl = document.getElementById('liveToast');
        const toastBody = document.getElementById('toastBody');

        // --- LOGIC ---

        // 1. Tab Switching Logic
        function switchTab(tabName) {
            // Reset all nav links
            document.querySelectorAll('.nav-link').forEach(el => el.classList.remove('active'));
            // Hide all panes
            document.querySelectorAll('.tab-pane').forEach(el => el.classList.remove('active'));

            // Activate selected
            if(tabName === 'dashboard') {
                document.querySelector('a[onclick="switchTab(\'dashboard\')"]').classList.add('active');
                document.getElementById('dashboard-pane').classList.add('active');
            } else {
                document.querySelector('a[onclick="switchTab(\'operations\')"]').classList.add('active');
                document.getElementById('operations-pane').classList.add('active');
            }
        }

        // 2. Toast Logic
        let toastTimeout;
        function showNotification(message, type = 'success') {
            // Set Color
            toastEl.className = 'toast show'; // reset
            if (type === 'success') toastEl.classList.add('bg-success');
            else if (type === 'error') toastEl.classList.add('bg-danger');
            
            // Set Text
            toastBody.textContent = message;
            
            // Auto hide after 3 seconds
            clearTimeout(toastTimeout);
            toastTimeout = setTimeout(() => {
                hideToast();
            }, 3000);
        }

        function hideToast() {
            toastEl.classList.remove('show');
        }

        // 3. Render Helpers
        function renderSeverityBadge(severity) {
            const lowerSev = severity.toLowerCase();
            return `<span class="badge ${'severity-' + lowerSev}">${severity}</span>`;
        }
        
        function updateDashboard() {
            // Update Stats
            totalAssetsEl.textContent = assets.length;
            totalVulnsEl.textContent = vulnerabilities.length;
            
            // Update Risk Table
            if (vulnerabilities.length === 0) {
                riskReportTableBody.innerHTML = '<tr><td colspan="4" class="text-center text-muted p-4">No vulnerabilities recorded yet.</td></tr>';
            } else {
                riskReportTableBody.innerHTML = vulnerabilities.map(v => `
                    <tr>
                        <td>${v.assetName}</td>
                        <td class="text-monospace">${v.cve}</td>
                        <td>${renderSeverityBadge(v.severity)}</td>
                        <td>${v.desc}</td>
                    </tr>
                `).join('');
            }
            
            // Update Asset Dropdown & Terminal View
            let assetOptions = '<option value="">Select an Asset...</option>';
            let assetTerminalView = '';
            
            assets.forEach(a => {
                assetOptions += `<option value="${a.id}">${a.id} - ${a.name} (${a.ip})</option>`;
                assetTerminalView += `
                    <div class="mb-1 text-nowrap">
                        { id: ${a.id}, name: '${a.name}', ip: '${a.ip}' }
                    </div>
                `;
            });
            
            vulnAssetSelect.innerHTML = assetOptions;
            currentAssetsList.innerHTML = assetTerminalView || '<div class="text-muted" style="font-style:italic">No assets to display.</div>';
        }

        // --- EVENT LISTENERS ---
        
        document.getElementById('addAssetForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const name = document.getElementById('assetName').value;
            const type = document.getElementById('assetType').value;
            const ip = document.getElementById('assetIP').value;
            const owner = document.getElementById('assetOwner').value;

            if (!name || !ip) {
                showNotification('Error: Name and IP are required.', 'error');
                return;
            }

            const newId = assets.length > 0 ? assets[assets.length - 1].id + 1 : 1;
            const asset = { id: newId, name, type, ip, owner };
            assets.push(asset);

            this.reset();
            updateDashboard();
            showNotification('Asset added successfully!');
        });
        
        document.getElementById('reportVulnForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const assetId = document.getElementById('vulnAssetId').value;
            const cve = document.getElementById('vulnCve').value;
            const desc = document.getElementById('vulnDesc').value;
            const severity = document.getElementById('vulnSeverity').value;
            
            if (!assetId || !cve) {
                showNotification('Error: Asset and CVE are required.', 'error');
                return;
            }
            
            const targetAsset = assets.find(a => a.id === parseInt(assetId));
            const assetName = targetAsset ? targetAsset.name : 'Unknown';
            
            const newId = vulnerabilities.length > 0 ? vulnerabilities[vulnerabilities.length - 1].id + 1 : 1;
            const vuln = { id: newId, assetId: parseInt(assetId), assetName, cve, desc, severity };
            vulnerabilities.push(vuln);

            this.reset();
            updateDashboard();
            showNotification('Vulnerability logged successfully!');
        });
        
        // Initial Load
        document.addEventListener('DOMContentLoaded', updateDashboard);
    </script>

</body>
</html>